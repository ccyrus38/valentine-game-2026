<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üíñ LOVE MEMORY - MISSION 2026</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #fff0f5; /* LavenderBlush */
            color: #881337; 
            overflow-x: hidden;
        }
        .mono-font { font-family: 'Share Tech Mono', monospace; }
        
        /* ÊÑõÂøÉÈ£ÑÊµÆÂãïÁï´ */
        @keyframes floatUp {
            0% { transform: translateY(100vh) scale(0.5) rotate(0deg); opacity: 0; }
            20% { opacity: 0.6; }
            100% { transform: translateY(-10vh) scale(1.2) rotate(360deg); opacity: 0; }
        }
        
        .floating-heart {
            position: fixed;
            pointer-events: none;
            z-index: 0;
            animation: floatUp linear infinite;
        }

        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .fade-in { animation: fadeIn 0.8s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Áõ∏Ê°ÜÊºÇÊµÆ */
        @keyframes gentleFloat {
            0%, 100% { transform: translateY(0) rotate(var(--rot)); }
            50% { transform: translateY(-10px) rotate(var(--rot)); }
        }
        .animate-gentle-float {
            animation: gentleFloat 6s ease-in-out infinite;
        }

        /* Èö±ËóèÊç≤Ëª∏‰ΩÜ‰øùÁïôÂäüËÉΩ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // üëáüëáüëá ÈÅäÊà≤Êï∏ÊìöÂçÄ üëáüëáüëá
        // ==========================================
        const GAME_DATA = {
            agentName: "È©äÂÆπÂ∞èÂØ∂Ë≤ù", 
            missionCode: "LOVE-2026",
            finalMessage: "Á≥ªÁµ±Ëß£ÈéñÊàêÂäüÔºÅ\n\nÂÖ∂ÂØ¶ÈÄôÂÄãÈÅäÊà≤ÁöÑÁµÇÈªû‰∏çÊòØÂØ∂ËóèÔºåËÄåÊòØÊàëÂÄë‰∏ÄËµ∑Ëµ∞ÈÅéÁöÑË∑Ø„ÄÇ\nÊÉÖ‰∫∫ÁØÄÂø´Ê®ÇÔºåÊàëÁöÑÊúÄÊÑõÂ§ßÂÇªBÔºÅ‚ù§Ô∏è",
            locations: [
                {
                    id: 1,
                    name: "Âè∞ÁÅ£ - Ëµ∑Èªû",
                    icon: "map-pin",
                    bgImage: "images/level1.jpg", 
                    description: "ÊàëÂÄëË¢´ÂÇ≥ÈÄÅÂà∞‰∫Ü‰∏ÄÂÄãÁÜüÊÇâÁöÑÂú∞ÊñπÔºåÁ©∫Ê∞£‰∏≠È£ÑËëóÁîúÁîúÁöÑÂë≥ÈÅì„ÄÇ",
                    searchPoints: [
                        { name: "Ê™¢Êü•Âè£Ë¢ã", content: "Âè™Êúâ‰∏ÄÂåÖËó•ÔºåÊòØÊÑüÂÜí‰∫ÜÂóé?" },
                        { name: "Êü•ÁúãËÉåÂåÖ", content: "ÊúâÁ¥ôÂ∑æÔºå‰Ω†ÂèØ‰ª•Áî®ÂÆÉÊì¶ÈºªÊ∂ïÔºå‰ΩÜÈÄô‰∏çÊòØÈóúÈçµ„ÄÇ" },
                        { name: "ÊíøËµ∑Âú∞‰∏äÁöÑÊî∂Êìö", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÈÄôÊòØ‰∏ÄÂºµÂÖÖÊªøÂ•∂È¶ôÁöÑÊî∂Êìö„ÄÇ‰Ω†ÂçÉËê¨‰∏çÊÉ≥ÈåØ‰∫Ü!\nÊàëÂÄëÁ¨¨‰∏ÄÊ¨°Á¥ÑÊúÉÁöÑÁîúÈªûÈ§êÂª≥ÂêçÂ≠óÊòØÔºü(ÂçÅÂÄãÂ≠ó)" }
                    ],
                    answer: "Âè∞‰∏≠Â∏ÇÁ¨¨Âõõ‰ø°Áî®Âêà‰ΩúÁ§æ", 
                    hint: "ÊèêÁ§∫ÔºöÊúâÈªûÂÜ∑ÔºåÊòØÂÆÆÂéüÁúºÁßëÁöÑÂàÜÂ∫ó"
                },
                {
                    id: 2,
                    name: "ÈáéÊü≥ - Â•áÁü≥Èô£",
                    icon: "wind",
                    bgImage: "images/level2.jpg",
                    description: "Âë®ÂúçÈÉΩÊòØÂ•áÊÄ™ÂΩ¢ÁãÄÁöÑÂ≤©Áü≥ÔºåÊµ∑È¢®ÂæàÂ§ßÔºå‰ºº‰πéÊúâ‰∏ÄÂÄãÁü≥È†≠Âú®ÁõØËëóÊàëÂÄëÁúã„ÄÇ",
                    searchPoints: [
                        { name: "ÊúõÂêëÊµ∑ÈÇä", content: "‰ªäÂ§©Â§©Ê∞£ÁúüÁöÑÂæàÁæéÂë¢„ÄÇ" },
                        { name: "Á©∂Á´üÊòØË™∞", content: "ÊòØË™∞ÊÑüÊüì‰∫ÜÊàëÂÄë!" },
                        { name: "Â∞ãÊâæÊúÄÈ´òÁöÑÈÇ£È°ÜÈ†≠", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\n‰Ω†ÁúãÈÄôÂÄãÁü≥È†≠ÁöÑËÑñÂ≠êË∂ä‰æÜË∂äÁ¥∞‰∫Ü„ÄÇ\nÂÆÉÁöÑÂêçÂ≠óÊòØÔºü" }
                    ],
                    answer: "Â•≥ÁéãÈ†≠",
                    hint: "ÊèêÁ§∫ÔºöKingÁöÑÁõ∏Âèç"
                },
                {
                    id: 3,
                    name: "ÈáëÂ±± - ÊìÅÊì†ÁöÑË°óÈÅì",
                    icon: "users",
                    bgImage: "images/level3.jpg",
                    description: "ÈÄôË£°‰∫∫Â±±‰∫∫Êµ∑ÔºåÂ§ßÂÆ∂ÊâãË£°ÈÉΩÂú®Ë°ó‰∏äËµ∞‰æÜËµ∞Âéª„ÄÇ",
                    searchPoints: [
                        { name: "ÂæÄÈÅ†ÈÇäËµ∞Ëµ∞", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÈÇ£ÂÄãÊòØ‰ªÄÈ∫º?!\nÊàëÂÄëÈÇ£Â§©ÊÉ≥ÂÅöÂçªÂÅö‰∏çÂà∞ÁöÑÊòØÔºü(ÂÖ©ÂÄãÂ≠ó)" },
                        { name: "ÁúãÂ∫óÂÆ∂ÊãõÁâå", content: "ÈÄôÊòØËä±ÁîüÁ≥ñÈòøÔºåÊÉ≥‰∏çÂà∞ÈÄôÈ∫ºÂ•ΩÂêÉ„ÄÇ" }
                    ],
                    answer: "Ê≥°ËÖ≥",
                    hint: "ÊèêÁ§∫ÔºöËÄÅÂ≠êË§≤ÈÉΩËÑ´‰∫ÜÔºå‰Ω†Ë™™Ê≤íÈñã"
                },
                {
                    id: 4,
                    name: "ÂÆúËò≠ - Â§ú‰πãÂ∏Ç",
                    icon: "moon",
                    bgImage: "images/level4.jpg",
                    description: "Â§©Èªë‰∫ÜÔºåËÇöÂ≠êÈ§ì‰∫Ü„ÄÇÈÄôË£°ÂÖÖÊªø‰∫ÜÂçúËÇâË∑üËî•È§ÖÁöÑÈ¶ôÂë≥„ÄÇ",
                    searchPoints: [
                        { name: "ÊâìÈñãGoogle Map", content: "GPSË®äËôüÂæÆÂº±..." },
                        { name: "ÂïèË∑Ø‰∫∫", content: "Ë∑Ø‰∫∫Ë™™ÔºöÂ∞±ÊòØÈÇ£ÂÄãÂæàÊúâÂêçÁöÑÂ§úÂ∏ÇÂïäÔºÅ" },
                        { name: "ÁúãÂÖ•Âè£Êã±ÈñÄ", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÊã±ÈñÄ‰∏äÂØ´ËëóÊàëÂÄëË¶ÅÂéªÁöÑÂ§úÂ∏ÇÂêçÂ≠ó„ÄÇ\nÂõõÂÄãÂ≠óÔºö" }
                    ],
                    answer: "ÁæÖÊù±Â§úÂ∏Ç",
                    hint: "ÊèêÁ§∫ÔºöÂ∞èÊò•"
                },
                {
                    id: 5,
                    name: "Êó•ÊúàÊΩ≠ - ÊπñÊ≥ä",
                    icon: "cloud-rain",
                    bgImage: "images/level5.jpg",
                    description: "‰∏ãËàπÂæåÊúâÂæàÂ§ö‰∫∫ÔºåÊàëÂÄëÁ´ôÂú®‰∏ÄËµ∑ÔºåÊâãË£°ÊãøËëó‰∏ÄÈ°ÜÁÜ±È®∞È®∞ÁöÑËõã„ÄÇ",
                    searchPoints: [
                        { name: "ÁúãÁúãÈÄôÂ∫ó", content: "Ëå∂ËëâÂ∫óËÄÅÈóÜÂ®òÁöÑÊÑõÊÉÖÊïÖ‰∫ãÁúüÊúâÊÑõÂë¢" },
                        { name: "ÂêÉ‰∏ÄÂè£Ëõã", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÈÄôÈ°ÜËõã‰∏çÂ§™Â•ΩÂêÉÔºåÊ≤íÊúâÈ†êÊúüÁöÑÈ¶ôËèáÂíåÁ¥ÖËå∂Âë≥ÈÅì„ÄÇ\nÊòØË™∞Ë≥£ÁöÑËå∂ËëâËõãÔºü(ÂÖ©ÂÄãÂ≠ó)" },
                        { name: "ÁúãËàπÁ•®", content: "Á•®‰∏äÂØ´Ëëó„ÄåÊ∞¥Á§æÁ¢ºÈ†≠„Äç„ÄÇ" }
                    ],
                    answer: "ÈòøÂ©Ü",
                    hint: "ÊèêÁ§∫ÔºöÂπ¥Á∫™ÂæàÂ§ßÁöÑÂ•≥ÊÄß"
                },
                {
                    id: 6,
                    name: "È¶ôÊ∏Ø - Ëø™Â£´Â∞ºÈ≠îÊ≥ïÂíí",
                    icon: "sparkles", 
                    bgImage: "images/level6.jpg",
                    description: "Âùê‰∏äÂ∞èÁÜäÁ∂≠Â∞ºÂÜíÈö™‰πãÊóÖÔºå‰∏ÄËµ∑Âá∫ÁôºÂõâ„ÄÇ",
                    searchPoints: [
                        { name: "ÂéªÂùêÊ£ÆÊûóÊ≤πÊµÅ‰πãÊóÖ", content: "ÂìáÔºåÈÇ£ÈöªÊ≤≥È¶¨Â•ΩËá≠Âì¶ÔºåÈÇ£ÂÄãËàπÈï∑‰∏ÄËáâÂæàÂé≠‰∏ñÁöÑÂú®Ë¨õÂÜ∑Á¨ëË©±Âë¢„ÄÇ" },
                        { name: "ÂéªÁæéÂúãÂ∞èÈéÆÂ§ßË°ó", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÈÇ£Èõ™Á≥ïÁúãËµ∑‰æÜÂæàÂ•ΩÂêÉÂë¢ÔºåÊòØÊúüÈñìÈôêÂÆöÁöÑ„ÄÇ\nÊàëÂÄëÂêÉ‰∫Ü‰ªÄÈ∫ºÂè£Âë≥ÁöÑÈõ™Á≥ïÔºü(ÂÖ©ÂÄãÂ≠ó)" }
                    ],
                    answer: "ÁôΩÊ°É",
                    hint: "ÊèêÁ§∫ÔºöÂ±ÅËÇ°"
                },
                {
                    id: 7,
                    name: "ÈπøÊ∏Ø - Á™ÑÂ∑∑Ëø∑ÂÆÆ",
                    icon: "minimize-2", 
                    bgImage: "images/level7.jpg",
                    description: "ÈÄôË£°ÁöÑÂ∑∑Â≠êÁ™ÑÂà∞ÂÖ©ÂÄã‰∫∫ÂæàÈõ£ÂêåÊôÇÈÄöÈÅéÔºåÊàëÂÄëÂ∑ÆÈªûÂç°‰Ωè„ÄÇ",
                    searchPoints: [
                        { name: "ÂòóË©¶ÈÄöÈÅé", content: "Â•ΩÊì†ÂïäÔºÅ" },
                        { name: "Âè™Êúâ‰∏ÄÂçäÁöÑ‰∫ï", content: "Èù†ÂçäÂÄã‰∫ïÔºåÈÄô‰πüÊòØÊôØÈªûÂóéÔºÅ" },
                        { name: "ÁúãÁâÜ‰∏äÁöÑÂ°óÈ¥â", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÈÄôÊ¢ùÂ∑∑Â≠êÁöÑÂêçÂ≠óÊúâÈªûÂÆ≥Áæû„ÄÇ\nËº∏ÂÖ•Â∑∑Â≠êÁöÑÂêçÂ≠ó(‰∏âÂÄãÂ≠ó)Ôºö" }
                    ],
                    answer: "Êë∏‰π≥Â∑∑",
                    hint: "ÊèêÁ§∫ÔºöÊàëÊúÄÊÑõÂÅöÁöÑ"
                },
                {
                    id: 8,
                    name: "ÂòâÁæ© - ÁÅ´ÈõûÈ£Ø",
                    icon: "utensils",
                    bgImage: "images/level8.jpg",
                    description: "‰æÜÂà∞ÈÄôÂ∫ßÂüéÂ∏ÇÔºåÁ©∫Ê∞£‰∏≠È£ÑËëóÈõûÊ≤πÁöÑÈ¶ôÂë≥„ÄÇ‰∏çÊòØ‰∏ÄËà¨ÁöÑÈõû„ÄÇ",
                    searchPoints: [
                        { name: "ËÅû‰∏ÄËÅûÂë≥ÈÅì", content: "Â´©ÁöÑÈõûËÇâÔºåÈÇÑÊúâÁÉ§ËÇâÊº¢Â†°„ÄÇ" },
                        { name: "ÁúãËèúÂñÆ", content: "Á´üÁÑ∂ÊúâÊØîÊàëÂÄëËÅ∞ÊòéÁöÑÈ≠öÔºå‰∏çÂèØËÉΩÁöÑ!" },
                        { name: "ÁúãÂà∞Â•áÊÄ™ÁöÑ‰∫∫", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÊòØÁÑ°ËáâÁî∑Ôºå‰ªñÊâã‰∏äÊãøËëó‰ªÄÈ∫ºÔºü\nËº∏ÂÖ•‰∏âÂÄãÂ≠óÔºö" }
                    ],
                    answer: "ÈáëÂÖÉÂØ∂",
                    hint: "ÊèêÁ§∫ÔºöÁôºÂÖâÁöÑ"
                },
                {
                    id: 9,
                    name: "ÈòøÈáåÂ±± - ÈªéÊòéË°åÂãï",
                    icon: "sunrise",
                    bgImage: "images/level9.jpg",
                    description: "Â•ΩÂÜ∑ÔºÅÁèæÂú®ÊòØÂáåÊô®ÔºåÂë®Âúç‰∏ÄÁâáÊºÜÈªëÔºåÊàëÂÄëÂú®Á≠âÂ∞èÁÅ´Ëªä„ÄÇ",
                    searchPoints: [
                        { name: "ÁúãÊâãÈå∂", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÊó•Âá∫ÊôÇÈñìÁ©∂Á´üÊòØÂπæÈªûÔºü\n(ÂπæÈªûÂπæÂàÜÔºå‰æãÂ¶Ç8Èªû02ÂàÜ)" },
                        { name: "ÂêÉ‰∫ÜË±¨ËÇâ‰∏∏", content: "Á®çÂæÆÊöñÂíå‰∫Ü‰∏ÄÈªû„ÄÇ" }
                    ],
                    answer: "5Èªû45ÂàÜ",
                    hint: "ÊèêÁ§∫ÔºöÂ§©ÈÇÑÊ≤í‰∫Æ"
                },
                {
                    id: 10,
                    name: "È´òÈõÑ - ÈñãËªäÂá∫Áôº",
                    icon: "heart",
                    bgImage: "images/level10.jpg",
                    description: "ÊàëÂÄëÈñãËµ∑‰∫ÜÈõªÂãïËªäÔºåÈÇÑÂ∑ÆÈªûÊíûËªä‰∫Ü„ÄÇ",
                    searchPoints: [
                        { name: "ÁúãÁúãËªäÂ≠ê", content: "ËªäÂ≠êÈÇÑÂ•ΩÔºå‰ΩÜÊõæÁ∂ìÊúâÈñãÈÅéËªäÁöÑÈ©äÂÆπÈñãÂæóÊàëÂøÉÈ©öËÜΩÈ°´„ÄÇ" },
                        { name: "ÂõûÊÉ≥Ë®òÊÜ∂", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÁÇ∫‰ªÄÈ∫ºÊàëÂÄëË¶ÅÈñãÂæóËÄÅÈÅ†ÁöÑÔºåÊòØÁÇ∫‰∫ÜË≤∑‰ªÄÈ∫º?\n‰Ω†Â∞±ÊòØÂ§ßÂÇªBÔºö" }
                    ],
                    answer: "Âú∞ÁìúÈÖ•",
                    hint: "ÊèêÁ§∫ÔºöÂÇªB"
                },
                {
                    id: 11,
                    name: "Êó•Êú¨ - Êú™‰æÜ‰πãÊóÖ",
                    icon: "heart",
                    bgImage: "images/level11.jpg",
                    description: "Â∞èÁ¢óÁ¢é‰∫ÜÊÄéÈ∫ºËæ¶",
                    searchPoints: [
                        { name: "ÁúãÁúãCyrus", content: "Á∑öÁ¥¢ÁôºÁèæÔºÅ\nÂ∞èÂØ∂Ë≤ù‰∏çË¶ÅÂì≠Âì≠ÔºåÊàëÂÄë‰∏ÄËµ∑ÂÜçÂéªË≤∑Â•Ω‰∫ÜÔºåÊàëÂè™ÊÉ≥Â∞ç‰Ω†Ë¨õ3ÂÄãÂ≠ó\n3ÂÄãÂ≠óÔºö" }
                    ],
                    answer: "ÊàëÊÑõ‰Ω†",
                    hint: "ÊèêÁ§∫ÔºöÊ≤íÊèêÁ§∫"
                }
            ]
        };

        // ==========================================
        // üõ†Ô∏è Á≥ªÁµ±ÁµÑ‰ª∂ (v5.1 ÂõûÊ≠∏Á∂ìÂÖ∏Êµ™Êº´Áâà) üõ†Ô∏è
        // ==========================================

        const FloatingHearts = () => {
            const [hearts, setHearts] = useState([]);
            useEffect(() => {
                const interval = setInterval(() => {
                    const id = Date.now();
                    const left = Math.random() * 100;
                    const duration = 10 + Math.random() * 10;
                    const size = 15 + Math.random() * 25;
                    setHearts(prev => [...prev, { id, left, duration, size }]);
                    setTimeout(() => {
                        setHearts(prev => prev.filter(h => h.id !== id));
                    }, duration * 1000);
                }, 600);
                return () => clearInterval(interval);
            }, []);
            return (
                <>
                    {hearts.map(h => (
                        <div key={h.id} className="floating-heart text-pink-300/40" style={{ left: `${h.left}%`, animationDuration: `${h.duration}s`, fontSize: `${h.size}px` }}>‚ô•</div>
                    ))}
                </>
            );
        };

        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            static getDerivedStateFromError(error) { return { hasError: true, error }; }
            render() {
                if (this.state.hasError) return <div className="p-4 text-red-500">System Error</div>;
                return this.props.children;
            }
        }

        const Icon = ({ name, className }) => {
            const [svgHtml, setSvgHtml] = useState(null);
            useEffect(() => {
                if (!window.lucide) return;
                const tempDiv = document.createElement('div');
                const iTag = document.createElement('i');
                iTag.setAttribute('data-lucide', name);
                if (className) iTag.setAttribute('class', className);
                tempDiv.appendChild(iTag);
                try {
                    window.lucide.createIcons({ root: tempDiv, nameAttr: 'data-lucide' });
                    setSvgHtml(tempDiv.innerHTML);
                } catch (e) { setSvgHtml(`<span>?</span>`); }
            }, [name]);
            if (!svgHtml) return <span className={`inline-block ${className || ''}`} style={{ width: '1em', height: '1em' }}></span>;
            return <span className={className} dangerouslySetInnerHTML={{ __html: svgHtml }} style={{ display: 'inline-flex', alignItems: 'center', justifyContent: 'center' }} />;
        };

        const TerminalLine = ({ text, delay = 0 }) => {
            const [display, setDisplay] = useState('');
            useEffect(() => {
                let i = 0;
                const timer = setTimeout(() => {
                    const interval = setInterval(() => {
                        setDisplay(text.substring(0, i + 1));
                        i++;
                        if (i === text.length) clearInterval(interval);
                    }, 50);
                    return () => clearInterval(interval);
                }, delay);
                return () => clearTimeout(timer);
            }, [text, delay]);
            return <div className="font-mono text-rose-500 mb-2 text-lg text-shadow-sm">‚ô• {display}<span className="animate-pulse">_</span></div>;
        };

        const GameContent = () => {
            const [gameState, setGameState] = useState('boot'); 
            const [currentLevelIndex, setCurrentLevelIndex] = useState(0);
            const [foundClue, setFoundClue] = useState(null);
            const [inputAnswer, setInputAnswer] = useState('');
            const [errorMsg, setErrorMsg] = useState('');
            const [logs, setLogs] = useState([]);
            const [isShaking, setIsShaking] = useState(false);
            const logsEndRef = useRef(null);

            useEffect(() => {
                if(logsEndRef.current) logsEndRef.current.scrollIntoView({ behavior: "smooth" });
            }, [logs]);

            useEffect(() => {
                if (gameState === 'boot') setTimeout(() => setGameState('locked'), 3800);
            }, [gameState]);

            const currentLevel = GAME_DATA.locations[currentLevelIndex];

            const addLog = (msg, type = 'info') => {
                const colors = { info: 'text-pink-600', warn: 'text-purple-600', error: 'text-red-500', success: 'text-rose-600' };
                setLogs(prev => [...prev, { time: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}), msg, color: colors[type] }]);
            };

            const handleSearch = (point) => {
                addLog(`Ê≠£Âú®Êü•Áúã: ${point.name}...`, 'info');
                setTimeout(() => {
                    if (point.content.includes("Á∑öÁ¥¢ÁôºÁèæ")) {
                        setFoundClue(point.content);
                        setGameState('solving');
                        addLog("‚ú® ÁôºÁèæÈáçË¶ÅÂõûÊÜ∂ÔºÅ", 'warn');
                        if (navigator.vibrate) navigator.vibrate(200);
                    } else {
                        addLog(`ÂõûÊÜ∂ÁâáÊÆµ: ${point.content}`, 'info');
                    }
                }, 600);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const cleanInput = inputAnswer.trim().toLowerCase().replace(/\s/g, '');
                const cleanAnswer = currentLevel.answer.toLowerCase().replace(/\s/g, '');

                addLog(`ÂøÉÈùàÊÑüÊáâ‰∏≠: ${inputAnswer}...`, 'info');

                if (cleanInput === cleanAnswer || cleanInput.includes(cleanAnswer)) {
                    addLog("ÂõûÁ≠îÊ≠£Á¢∫ÔºÅÊÑõÂøÉËß£ÈéñÊàêÂäü ‚ù§Ô∏è", 'success');
                    setGameState('unlocked');
                    if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
                    setTimeout(() => {
                        if (currentLevelIndex + 1 < GAME_DATA.locations.length) {
                            setCurrentLevelIndex(prev => prev + 1);
                            setGameState('searching');
                            setFoundClue(null);
                            setInputAnswer('');
                        } else {
                            setGameState('victory');
                        }
                    }, 2500);
                } else {
                    setErrorMsg('Â∞èÂÇªB'); 
                    addLog("ÈåØË™§Ôºö‰∏çÊòØÈÄôÂÄãÂñîÔΩû", 'error');
                    setIsShaking(true);
                    setInputAnswer('');
                    if (navigator.vibrate) navigator.vibrate(500);
                    setTimeout(() => { setErrorMsg(''); setIsShaking(false); }, 1500);
                }
            };

            // 1. Boot Screen
            if (gameState === 'boot') {
                return (
                    <div className="h-screen bg-pink-50 flex flex-col items-center justify-center font-mono text-pink-600 p-6 relative">
                        <FloatingHearts />
                        <div className="w-full max-w-md bg-white/40 backdrop-blur-md p-8 rounded-3xl shadow-xl border border-pink-100/50">
                            <TerminalLine text="Ê≠£Âú®ËºâÂÖ•ÁîúËúúÂõûÊÜ∂..." delay={0} />
                            <TerminalLine text="ÂêåÊ≠•ÊÑõÂøÉÈ†ªÁéá‰∏≠..." delay={1000} />
                            <TerminalLine text={`ÁõÆÊ®ôÂ∞çË±°: ${GAME_DATA.agentName}`} delay={2000} />
                            <TerminalLine text="Ê∫ñÂÇôÈñãÂïüÊàÄÊÑõÂÜíÈö™..." delay={3000} />
                        </div>
                    </div>
                );
            }

            // 2. Start Screen
            if (gameState === 'locked') {
                return (
                    <div className="h-screen bg-rose-50 flex flex-col items-center justify-center p-6 relative overflow-hidden">
                        <FloatingHearts />
                        <div className="z-10 text-center space-y-8 max-w-lg w-full">
                            <div className="flex justify-center mb-6">
                                <div className="bg-white/60 p-6 rounded-full shadow-xl border-4 border-pink-100 backdrop-blur-md animate-bounce">
                                    <Icon name="lock" className="w-16 h-16 text-rose-400" />
                                </div>
                            </div>
                            <div>
                                <h1 className="text-4xl font-bold text-rose-800 mb-2 tracking-widest drop-shadow-sm">LOCKED MEMORY</h1>
                                <p className="text-rose-400 mono-font text-sm tracking-widest bg-white/50 inline-block px-4 py-1 rounded-full">MISSION: {GAME_DATA.missionCode}</p>
                            </div>
                            <div className="bg-white/50 border border-pink-100 p-8 rounded-3xl backdrop-blur-md text-left shadow-xl">
                                <p className="text-rose-800 mb-6 leading-relaxed text-lg font-medium">
                                    Ë¶™ÊÑõÁöÑ <strong className="text-pink-500">{GAME_DATA.agentName}</strong>ÔºåÁ≥ªÁµ±ÂÅµÊ∏¨Âà∞Â§ßÈáèÊàëÂÄëÁèçË≤¥ÁöÑÂõûÊÜ∂Ê™îÊ°à„ÄÇ
                                    Ë´ãËß£ÈñãÊÑõÁöÑÂØÜÁ¢º„ÄÇ
                                </p>
                                <button onClick={() => setGameState('searching')} className="w-full bg-rose-400 hover:bg-rose-500 text-white font-bold text-xl py-4 rounded-full shadow-lg shadow-rose-200 transition-all active:scale-95">
                                    [ ÈñãÂßãÊÑõÁöÑÂÜíÈö™ ]
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // 5. Victory Screen
            if (gameState === 'victory') {
                return (
                    <div className="h-screen bg-pink-50 flex flex-col items-center justify-center p-6 text-center">
                        <FloatingHearts />
                        <div className="mb-8 relative animate-bounce">
                            <Icon name="heart" className="w-40 h-40 text-rose-500 fill-rose-500 drop-shadow-xl" />
                        </div>
                        <div className="bg-white/60 backdrop-blur-md border border-pink-200 p-8 rounded-3xl max-w-lg w-full shadow-2xl fade-in">
                            <h2 className="text-3xl font-bold text-rose-600 mb-4">MISSION COMPLETE!</h2>
                            <div className="text-rose-800 text-lg whitespace-pre-line leading-relaxed mb-6 font-medium">{GAME_DATA.finalMessage}</div>
                            <div className="border-t border-pink-200 pt-4">
                                <p className="text-sm text-rose-400 mono-font mb-2">Â∞àÂ±¨ÁçéÂãµ‰ª£Á¢º:</p>
                                <div className="text-2xl font-mono font-bold text-rose-600 tracking-[0.2em] select-all bg-white/50 p-3 rounded-xl border border-pink-200 dashed">FOREVER-US</div>
                            </div>
                        </div>
                    </div>
                );
            }

            // 3 & 4. Gameplay (Reverted Layout with Enhanced Visuals)
            return (
                <div className="min-h-screen bg-rose-50 text-rose-900 flex flex-col relative pb-40">
                    <FloatingHearts />

                    {/* === ËÉåÊôØÂ±§ === */}
                    <div className="fixed inset-0 z-0 overflow-hidden pointer-events-none">
                        <div className="absolute inset-0 bg-gradient-to-br from-rose-50 via-pink-50 to-rose-100"></div>

                        {/* ÊâãÊ©üÁâàËÉåÊôØÂúñ (ÂÖ®Ëû¢ÂπïÔºå‰∏çË£ÅÂàá) */}
                        <div className="md:hidden absolute inset-0 flex items-center justify-center">
                            <img 
                                src={currentLevel.bgImage} 
                                className="w-full h-full object-contain opacity-100" 
                                alt="background"
                            />
                            {/* Â∫ïÈÉ®Êº∏Â±§ÔºåÁ¢∫‰øùLogÊ∏ÖÊô∞ */}
                            <div className="absolute inset-x-0 bottom-0 h-1/3 bg-gradient-to-t from-white/95 to-transparent"></div>
                        </div>

                        {/* ÈõªËÖ¶Áâà: Â∑¶Âè≥Áõ∏Ê°Ü */}
                        <div className="hidden md:block absolute inset-0">
                            <div className="absolute left-[2%] top-24 w-[35vw] h-[60vh] bg-white/20 backdrop-blur-md border border-white/40 p-3 shadow-2xl rounded-2xl transform transition-all animate-gentle-float" style={{ '--rot': '-4deg' }}>
                                <div className="w-full h-full bg-white/40 rounded-xl overflow-hidden shadow-inner flex items-center justify-center relative">
                                    <img src={currentLevel.bgImage} className="w-full h-full object-contain" />
                                </div>
                            </div>
                            <div className="absolute right-[2%] top-24 w-[35vw] h-[60vh] bg-white/20 backdrop-blur-md border border-white/40 p-3 shadow-2xl rounded-2xl transform transition-all animate-gentle-float" style={{ '--rot': '4deg', animationDelay: '1s' }}>
                                <div className="w-full h-full bg-white/40 rounded-xl overflow-hidden shadow-inner flex items-center justify-center relative">
                                    <img src={currentLevel.bgImage} className="w-full h-full object-contain" />
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Header */}
                    <div className="bg-white/50 backdrop-blur-md border-b border-pink-100 p-4 flex justify-between items-center sticky top-0 z-30 shadow-sm">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-pink-100/50 rounded-full flex items-center justify-center border border-pink-200 shadow-sm">
                                <Icon name={currentLevel.icon} className="text-pink-500 w-6 h-6" />
                            </div>
                            <div>
                                <div className="text-[10px] text-pink-400 mono-font tracking-widest">LOC.{currentLevel.id}</div>
                                <div className="font-bold text-lg text-rose-800">{currentLevel.name}</div>
                            </div>
                        </div>
                        <div className="flex flex-col items-end">
                            <div className="mono-font text-xs text-pink-400">LEVEL</div>
                            <div className="text-rose-500 font-mono font-bold text-lg">{Math.round(((currentLevelIndex) / GAME_DATA.locations.length) * 100)}%</div>
                        </div>
                    </div>

                    {/* Main Content (‰∏≠ÈñìÊç≤ÂãïÂçÄ) */}
                    <main className="flex-1 p-6 max-w-2xl mx-auto w-full flex flex-col gap-6 z-10">
                        {/* ÊèèËø∞Ê°Ü */}
                        <div className="bg-white/60 p-6 rounded-3xl border border-white/60 relative overflow-hidden shadow-lg backdrop-blur-md">
                            <div className="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
                                <Icon name={currentLevel.icon} className="w-40 h-40 text-pink-500" />
                            </div>
                            <h3 className="text-pink-500 font-bold mb-3 text-sm mono-font tracking-wider flex items-center gap-2">
                                <Icon name="map" className="w-4 h-4" /> SCENE DESCRIPTION
                            </h3>
                            <p className="text-lg leading-relaxed text-rose-900 font-medium relative z-10">{currentLevel.description}</p>
                        </div>

                        {gameState === 'searching' ? (
                            <div className="space-y-4 fade-in">
                                <div className="text-xs text-rose-400 mono-font mb-2 text-center bg-white/40 py-1 rounded-full backdrop-blur-sm border border-white/20 inline-block px-4 mx-auto block w-fit">--- Ë´ãÈÅ∏ÊìáË™øÊü•ÂçÄÂüü ---</div>
                                <div className="grid grid-cols-1 gap-4">
                                    {currentLevel.searchPoints.map((point, idx) => (
                                        <button key={idx} onClick={() => handleSearch(point)} className="group bg-white/70 hover:bg-white/90 border border-white/50 p-5 rounded-2xl text-left flex items-center justify-between shadow-sm hover:shadow-md active:scale-[0.98] transition-all backdrop-blur-sm">
                                            <span className="flex items-center gap-4 text-lg font-bold text-rose-800">
                                                <div className="bg-pink-100/50 p-2 rounded-full group-hover:bg-pink-200 transition-colors text-pink-500">
                                                    <Icon name="search" className="w-5 h-5" />
                                                </div>
                                                {point.name}
                                            </span>
                                            <Icon name="chevron-right" className="w-5 h-5 text-pink-300 group-hover:text-pink-500" />
                                        </button>
                                    ))}
                                </div>
                            </div>
                        ) : gameState === 'solving' ? (
                            <div className="fade-in bg-white/70 border border-white/50 p-6 rounded-3xl shadow-xl backdrop-blur-md">
                                <div className="flex gap-4 mb-6 bg-pink-50/50 p-4 rounded-2xl border border-pink-100">
                                    <div className="bg-pink-200 p-3 rounded-full h-fit">
                                        <Icon name="key" className="w-5 h-5 text-pink-600" />
                                    </div>
                                    <div>
                                        <h3 className="text-pink-500 font-mono text-xs mb-1 font-bold tracking-wider">‚ú® SECRET FOUND</h3>
                                        <p className="text-rose-900 font-bold leading-relaxed">{foundClue}</p>
                                    </div>
                                </div>

                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div className="relative">
                                        <input 
                                            type="text" 
                                            value={inputAnswer}
                                            onChange={(e) => setInputAnswer(e.target.value)}
                                            placeholder="Ë´ãËº∏ÂÖ•ÊÑõÁöÑÂØÜÁ¢º..."
                                            className={`w-full bg-white/60 border-2 ${errorMsg ? 'border-red-400' : 'border-pink-200 focus:border-pink-400'} text-rose-600 font-mono text-xl py-4 px-6 rounded-full outline-none text-center tracking-widest placeholder:text-pink-300 shadow-inner transition-all backdrop-blur-sm ${isShaking ? 'shake' : ''}`}
                                            autoFocus
                                            autoComplete="off"
                                        />
                                        {errorMsg && (
                                            <div className="absolute top-full left-0 w-full text-center text-red-500 font-bold text-sm mt-2 animate-bounce">
                                                {errorMsg}
                                            </div>
                                        )}
                                    </div>
                                    <button className="w-full bg-gradient-to-r from-rose-400 to-pink-500 hover:from-rose-500 hover:to-pink-600 text-white font-bold text-lg py-4 rounded-full shadow-lg shadow-pink-200/50 active:scale-95 transition-all">
                                        UNLOCK / Ëß£ÈéñÂõûÊÜ∂
                                    </button>
                                    <div className="text-center">
                                        <button type="button" className="text-xs text-pink-400 hover:text-pink-600 underline decoration-dotted p-2" onClick={() => alert(currentLevel.hint)}>
                                            [ ÂÅ∑ÂÅ∑ÁúãÊèêÁ§∫ ]
                                        </button>
                                    </div>
                                </form>
                            </div>
                        ) : (
                            <div className="flex flex-col items-center justify-center py-12 animate-pulse text-pink-500 transform scale-110 transition-transform duration-500">
                                <div className="p-6 rounded-full bg-white/60 mb-6 shadow-xl border-4 border-pink-50">
                                    <Icon name="unlock" className="w-16 h-16" />
                                </div>
                                <div className="mono-font text-2xl font-bold tracking-widest text-white drop-shadow-md text-stroke">ACCESS GRANTED</div>
                            </div>
                        )}
                    </main>

                    {/* Log Area */}
                    <div className="fixed bottom-0 left-0 w-full bg-white/80 border-t border-pink-100 p-3 h-32 font-mono text-sm shadow-[0_-4px_20px_rgba(0,0,0,0.05)] z-40 backdrop-blur-md">
                        <div className="text-pink-400 text-[10px] mb-2 flex justify-between px-2">
                            <span>‚ô• LOVE LOG // v5.1</span>
                            <span className="animate-pulse text-rose-500">‚óè LIVE</span>
                        </div>
                        <div className="overflow-y-auto h-20 flex flex-col space-y-1 scroll-smooth px-2">
                            {logs.map((log, i) => (
                                <div key={i} className={`${log.color} break-words font-medium`}>
                                    <span className="opacity-50 text-xs">[{log.time}]</span> {log.msg}
                                </div>
                            ))}
                            <div ref={logsEndRef} />
                            {logs.length === 0 && <span className="text-pink-300 italic">> Á≠âÂæÖËº∏ÂÖ•‰∏≠...</span>}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            return (
                <ErrorBoundary>
                    <GameContent />
                </ErrorBoundary>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
